<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="4.0" xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx">
  <edmx:Reference Uri="https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Aggregation.V1.xml">
    <edmx:Include Namespace="Org.OData.Aggregation.V1" Alias="Aggregation" />
  </edmx:Reference>
  <edmx:Reference Uri="https://sap.github.io/odata-vocabularies/vocabularies/UI.xml">
    <edmx:Include Namespace="com.sap.vocabularies.UI.v1" Alias="UI" />
  </edmx:Reference>
  <edmx:Reference Uri="https://sap.github.io/odata-vocabularies/vocabularies/Analytics.xml">
    <edmx:Include Namespace="com.sap.vocabularies.Analytics.v1" Alias="Analytics" />
  </edmx:Reference>
  <edmx:DataServices>
    <Schema Namespace="DynamicProperties.examples" xmlns="http://docs.oasis-open.org/odata/ns/edm">

      <EntityType Name="Sales">
        <Key>
          <PropertyRef Name="Order"/>
        </Key>
        <Property Name="Order" Type="Edm.String" Nullable="false"/>
        <Property Name="Country" Type="Edm.String" Nullable="false"/>
        <Property Name="NumberOfItems" Type="Edm.Int16" Nullable="false"/>
        <Property Name="Amount" Type="Edm.Decimal"/>
        <Annotation Term="Analytics.AggregatedProperties" Qualifier="sum">
          <Collection> <!-- collection always has one entry that can be referenced with index segment /0 -->
            <Record>
              <PropertyValue Property="Name" String="Total"/>
              <PropertyValue Property="AggregationMethod" String="sum"/>
              <PropertyValue Property="AggregatableProperty" PropertyPath="Amount"/>
            </Record>
          </Collection>
        </Annotation>
        <Annotation Term="Analytics.AggregatedProperties" Qualifier="max">
          <Collection>
            <Record>
              <PropertyValue Property="Name" String="Maximum"/>
              <PropertyValue Property="AggregationMethod" String="max"/>
              <PropertyValue Property="AggregatableProperty" PropertyPath="Amount"/>
            </Record>
          </Collection>
        </Annotation>
        <Annotation Term="UI.Chart">
          <Record>
            <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bubble"/>
            <PropertyValue Property="Dimensions">
              <Collection>
                <PropertyPath>Country</PropertyPath>
              </Collection>
            </PropertyValue>
            <PropertyValue Property="Measures">
              <Collection>
                <PropertyPath>NumberOfItems</PropertyPath>
              </Collection>
            </PropertyValue>
            <PropertyValue Property="DynamicMeasures">
              <Collection>
                <AnnotationPath>@Analytics.AggregatedProperties#sum/0</AnnotationPath>
                <AnnotationPath>/Container/me/SalesOrders@Aggregation.CustomAggregate#WeightedAverage</AnnotationPath>
              </Collection>
            </PropertyValue>
          </Record>
        </Annotation>
        <Annotation Term="UI.PresentationVariant">
          <Record>
            <PropertyValue Property="SortOrder">
              <Collection>
                <Record>
                  <PropertyValue Property="Property" PropertyPath="Country"/>
                </Record>
                <Record>
                  <PropertyValue Property="DynamicProperty" AnnotationPath="@Analytics.AggregatedProperties#sum/0"/>
                  <PropertyValue Property="Descending" Boolean="true"/>
                </Record>
                <Record>
                  <PropertyValue Property="DynamicProperty" AnnotationPath="/Container/me/SalesOrders@Aggregation.CustomAggregate#WeightedAverage"/>
                </Record>
              </Collection>
            </PropertyValue>
          </Record>
        </Annotation>
      </EntityType>
      <EntityType Name="meType">
        <NavigationProperty Name="SalesOrders" Type="Collection(DynamicProperties.examples.Sales)" ContainsTarget="true"/>
      </EntityType>
      <EntityContainer Name="Container">
        <Singleton Name="me" Type="DynamicProperties.examples.meType"/>
      </EntityContainer>
      <Annotations Target="Container/me/SalesOrders">
        <Annotation Term="Aggregation.CustomAggregate" Qualifier="WeightedAverage" String="Edm.Decimal"/>
      </Annotations>

    </Schema>
  </edmx:DataServices>
</edmx:Edmx>